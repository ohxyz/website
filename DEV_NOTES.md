# Development Notes

## Overview

Static website for Overwatch character Winston, built with AngularJS 1.x, jQuery, and Gulp. Deployed via GitHub Pages from the `docs/` folder.

## Prerequisites

- **Node.js v8** (see .nvmrc)
- npm

## Setup

```bash
npm install
```

## Project Structure

```
website/
├── src/                    # SOURCE FILES - Edit these
│   ├── index.html         # Modern Angular component architecture
│   ├── angular/           # Angular components (stats, patch-notes, footer)
│   └── static/
│       ├── script/        # JS: 0.js, popup.js, libraries
│       ├── style/         # CSS and assets (images, fonts, videos)
│       └── patch-notes/   # HTML patch note files
│
└── docs/                  # BUILD OUTPUT + GITHUB PAGES SOURCE
    ├── index.html        # ⚠️ MANUALLY MAINTAINED (different from src/)
    ├── angular/          # ⚠️ PARTIALLY SYNCED
    └── static/           # Auto-generated by Gulp
```

## ⚠️ The docs/ Directory: CRITICAL

The `docs/` folder serves **TWO purposes**:

1. **Build Output** - Like `dist/`, contains minified production files
2. **GitHub Pages Source** - Serves the live website directly

**Implications:**
- **DO NOT DELETE** - would break deployment and lose built files
- Pushes to GitHub immediately affect the live site
- Build process writes directly to deployment source
- Some files require manual sync (see warnings below)

**History:** Renamed from `dist/` → `docs/` (commit 6f365cc) to enable GitHub Pages deployment.

## Quick Workflow

### Standard Changes (CSS, JS, Assets)

1. Edit files in `src/`
2. Run `npm run build`
3. Test in `docs/` folder with local server
4. Commit both `src/` and `docs/`

### Manual Sync Required (HTML, Angular)

1. Edit in `src/`
2. **Manually copy/update** to `docs/`
3. Test in `docs/`
4. Commit both folders

## What Gulp Build Does

**Automated by `npm run build`:**
- ✅ Concatenate `popup.js` + `0.js` → `concated.js`
- ✅ Minify JS → `docs/static/script/concated.min.js`
- ✅ Minify CSS → `docs/static/style/*.min.css`
- ✅ Copy assets (images, fonts, videos) to `docs/static/style/`
- ✅ Copy libraries (jQuery, Angular, etc.) to `docs/static/script/`
- ✅ Copy patch notes to `docs/static/patch-notes/`

**NOT Automated:**
- ❌ `index.html` (must manually sync)
- ❌ Angular components/templates (must manually sync)

## ⚠️ CRITICAL WARNINGS

### 1. Incomplete Build System

The build system was never finished. It only handles CSS/JS/assets.

**index.html is NOT copied:**
- `src/index.html` uses Angular components (`<patch-notes-section>`, `<stats-section>`)
- `docs/index.html` has hardcoded HTML (legacy version)
- They are **intentionally different** - incomplete refactoring from commit 7b3b815
- Changes to `src/index.html` do **NOT** affect deployment

**Angular files are NOT synced:**
- `docs/angular/` only has: `angular.min.js`, `app.js`, `ohxyz-com-stats.json`, `player-stats.template.html`
- Missing: All component JS files and most templates
- Must manually copy any changes

### 2. What to Edit Where

**Safe to edit in `src/` only (build handles):**
- `src/static/script/0.js`, `popup.js`
- `src/static/style/0.css`
- Assets in `src/static/style/images|fonts|videos/`
- `src/static/patch-notes/*.html`

**Requires manual sync:**
- `src/index.html` → update `docs/index.html` manually
- `src/angular/**/*` → copy to `docs/angular/**/*` manually

**Never edit directly (gets overwritten):**
- `docs/static/script/concated.min.js`
- `docs/static/style/*.min.css`
- `docs/static/style/images|fonts|videos/*`
- `docs/static/patch-notes/*`

### 3. Two Architecture Versions

The project has two coexisting HTML structures:

- **src/**: Component-based (modern, cleaner, incomplete)
- **docs/**: Hardcoded HTML (legacy, what's deployed)

You're maintaining both. Structure changes need to be made in both places.

## Common Workflows

### Edit JavaScript

```bash
# Edit src/static/script/0.js or popup.js
npm run build
# Changes appear in docs/static/script/concated.min.js
```

### Edit CSS

```bash
# Edit src/static/style/0.css
npm run build
# Changes appear in docs/static/style/0.min.css
```

### Edit HTML Structure

```bash
# Option A: Update docs/ only (practical)
# Edit docs/index.html directly

# Option B: Maintain both (ideal but more work)
# Edit src/index.html, then manually update docs/index.html
```

### Edit Angular Components

```bash
# Edit src/angular/**/*.component.js or *.template.html
# Manually copy changed files to docs/angular/
# OR update docs/index.html with hardcoded equivalent
```

### Add Assets

```bash
# Add to src/static/style/images/ (or fonts/, videos/)
npm run build
# Automatically copied to docs/static/style/
```

### Add Patch Notes

```bash
# 1. Create src/static/patch-notes/YYYY-MM-DD.html
# 2. Update docs/index.html patch notes list
npm run build
# HTML file copied to docs/static/patch-notes/
```

## Testing Locally

```bash
cd docs
python -m http.server 8000
# Or: npx http-server
```

Visit http://localhost:8000

## Path Guidelines

Use **relative paths** for deployment flexibility (works at root or `/docs` subdirectory):

- ✅ `href="./"` or `src="static/script/file.js"`
- ❌ `href="/"` or `src="/static/script/file.js"` (only works at root)

## Deployment Checklist

1. Run `npm run build`
2. Test locally in `docs/`
3. Verify manual syncs (index.html, Angular if changed)
4. Commit both `src/` and `docs/`
5. Push to GitHub

GitHub Pages serves the updated `docs/` folder within minutes.

## Troubleshooting

**Changes don't appear:**
- Did you edit `src/` (not `docs/`)?
- Did you run `npm run build`?
- Testing from `docs/` folder?
- Clear browser cache?

**Components not working:**
- Check `docs/angular/` has required component files
- Check browser console for 404 errors
- Verify `docs/index.html` references components correctly

**Styles not updating:**
- Edit `src/static/style/0.css`, not `docs/`
- Run `npm run build`
- Clear browser cache

## Key Files

- **gulpfile.js** - Build configuration (concat, minify, copy tasks)
- **src/static/script/0.js** - Mobile menu, quotes, sticky nav, video modal
- **src/static/script/popup.js** - Custom modal/popup library
- **src/angular/app.js** - AngularJS main module

## Summary

**Remember:**
- `docs/` is both build output AND live deployment
- Build system is incomplete - manual syncing required for HTML/Angular
- Always test in `docs/` before pushing
- Commit both `src/` and `docs/` together
